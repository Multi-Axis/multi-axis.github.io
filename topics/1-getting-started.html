<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Multi-Axis - Getting Started</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Multi-Axis Documentation</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
            </div>
        </div>
        <div id="content">
            <h1>Getting Started</h1>
            <div class="info">
    
</div>

<h2 id="database-and-habbix">Database and habbix</h2>
<ul>
<li>Create the database (<code>createdb -O multi-axis multiaxis</code>)</li>
<li>Set <code>localDatabase</code> and <code>remoteDatabase</code> in <code>config.yaml</code> (for habbix)</li>
<li>Run <code>habbix migratedb</code>.</li>
<li>Sync local “meta” (that is, all but history tables) tables from zabbix: <code>habbix sync --syncall</code>.</li>
</ul>
<p>The history tables are rather large (over 300k rows <em>with a single server</em>), so it is not wise to sync all of them.</p>
<h2 id="first-prediction-unit">First prediction unit</h2>
<p>Now, the following may sound a bit confusing but please bear with me. Because <strong>history is coupled with future</strong>, you will need to define some means to predict the future before syncing the history. That is, some (“future-predicting!”) executable(s) in <code>$PWD/forecast_models</code>. For now you may want to copy or link the <code>linreg</code> binary from habbix:</p>
<pre><code> mkdir future_models
 cd future_models
 ln -s ~/.cabal/bin/linreg .</code></pre>
<p>Then register it in the database: <code>habbix configure -e linreg</code>. Refer to section “Predictions” for more info on models.</p>
<p>Now you can register some items in the database. To see what items have any history, you can e.g. do something like this on the <strong>remote zabbix db</strong> psql:</p>
<pre><code>zabbix=&gt; select distinct itemid from history;
zabbix=&gt; select distinct itemid from history_uint;</code></pre>
<p>You need to know the itemid you want to add. For example’s sake let’s have a fictional items.itemid = 20000 and configure a prediction for it with the model with modelid = 1:</p>
<pre><code>habbix configure -i 20000 -m 1</code></pre>
<p>(Tip: List all models with <code>habbix models</code>.)</p>
<h2 id="data-synchronization-with-habbix">Data synchronization with habbix</h2>
<p>Now you can synchronize the history from the remote db and predict the future:</p>
<pre><code>habbix sync</code></pre>
<p>That syncs only histories and futures; if you have added new hosts, you will need to run habbix <code>sync --syncall</code> first.</p>
<h2 id="web-server">Web server</h2>
<p>In a nutshell: run <code>go run zab2.go</code> at the root of the multi-axis-graphs repo. You probably need to change db connection settings inside the go file to reflect those in config.yaml.</p>
<h3 id="optimizations">Optimizations</h3>
<p>DB indices; increases dashboard performance manyfold.</p>
<pre><code>create index history_idx on history (itemid, clock);
create index trend_idx on trend (itemid, clock);
alter table trend drop column id;
alter table history drop column id;</code></pre>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
