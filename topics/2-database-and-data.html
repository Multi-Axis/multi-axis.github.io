<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>Multi-Axis - Database and Data</title>
        <link rel="stylesheet" type="text/css" href="../css/default.css" />
    </head>
    <body>
        <div id="header">
            <div id="logo">
                <a href="../">Multi-Axis Documentation</a>
            </div>
            <div id="navigation">
                <a href="../">Home</a>
            </div>
        </div>
        <div id="content">
            <h1>Database and Data</h1>
            <div class="info">
    
</div>

<p>The local schema is generated by the template haskell in <a href="https://github.com/Multi-Axis/habbix/blob/master/src/Models.hs" class="uri">https://github.com/Multi-Axis/habbix/blob/master/src/Models.hs</a>. The definitions use a little different naming from the real db, but you should be able to figure out the differences. For clarity I’ll stick to names used in the actual postgresql database in this document.</p>
<p>All table and field names that are <em>above</em> the <code>Not in Zabbix</code> comment are also present in the remote zabbix db. Tables below that comment are present <em>only</em> in the local schema.</p>
<h2 id="items">Items</h2>
<p><code>items.itemid</code> is the most important field in our database. itemids are used everywhere to identify a single metric. An item qualifies the host, too.</p>
<h2 id="history">History</h2>
<p>History data, (time, value)-points, are in the <code>history</code> and <code>history_uint</code> tables. Nearly dually, future data is in <code>future</code> and <code>future_uint</code> tables.</p>
<p>item history:</p>
<pre><code>select clock, value from history where itemid = &lt;items.itemid&gt; order by clock;
(or ints:)
select clock, value from history_uint where itemid = &lt;items.itemid&gt; order by clock;</code></pre>
<h2 id="predictions-and-futures">Predictions and Futures</h2>
<p>Item’s all precomputed “prediction futures” are in the <code>item_future</code> table:</p>
<pre><code>select id, modelid, params from item_future where itemid = &lt;items.itemid&gt;;</code></pre>
<p>Fetch future data:</p>
<pre><code>select clock, value from future where itemid = &lt;item_future.id&gt; order by clock;
(or ints:)
select clock, value from future_uint where itemid = &lt;item_future.id&gt; order by clock;</code></pre>
<h2 id="pretty-names">Pretty Names</h2>
<p>We provide pretty names for common <code>items.key_</code>’s in the <code>metric</code> database:</p>
<pre><code> id | name |             key_
----+------+------------------------------
  1 | mem  | system.stat[memory,fre]
  2 | cpu  | system.cpu.load[percpu,avg5]</code></pre>

        </div>
        <div id="footer">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
